# ESP32 物联网控制面板

这是一个基于 OneNET MQTT 的物联网控制面板，用于控制 ESP32 的 LED、风扇等外设，并显示温湿度数据。

## 功能列表

- 实时显示温度数据
- 实时显示湿度数据
- LED 开关控制
- 风扇开关控制
- 风扇速度调节（关闭/低速/中速/高速）

## 调试指南

### 1. 前端调试

1. 打开浏览器开发者工具（F12）
2. 切换到 Console 标签页
3. 观察以下信息：
   - MQTT 连接状态信息
   - 收到的消息数据
   - 可能的错误信息

### 2. MQTT 连接测试

可以使用 MQTT.fx 或 MQTT Explorer 工具进行测试：

1. 连接信息：
   - 服务器：mqtts.heclouds.com
   - 端口：8083（WebSocket）
   - 客户端ID：任意（建议以"test_"开头）
   - 用户名：Fiw8h1D03X
   - 密码：见 app.js 中的配置

2. 测试主题：
   - 发布主题：$sys/Fiw8h1D03X/d1/thing/property/post
   - 订阅主题：$sys/Fiw8h1D03X/d1/thing/property/post

3. 测试数据格式：
```json
{
    "id": "123",
    "version": "1.0",
    "params": {
        "temp": {
            "value": 25.5
        },
        "humi": {
            "value": 65
        },
        "led": {
            "value": true
        },
        "fan_switch": {
            "value": true
        },
        "fan_speed": {
            "value": 2
        }
    }
}
```

### 3. 常见问题排查

1. 连接失败：
   - 检查网络连接
   - 验证 MQTT 配置信息
   - 确认服务器是否支持 WebSocket

2. 数据不更新：
   - 检查订阅主题是否正确
   - 查看控制台是否有错误信息
   - 验证数据格式是否正确

3. 控制命令无响应：
   - 确认发布主题是否正确
   - 检查 payload 格式是否符合要求
   - 验证 ESP32 是否正确接收和处理命令

## 测试步骤

1. 基础连接测试：
   - 打开网页，观察控制台是否显示"MQTT连接成功"
   - 检查是否有连接错误信息

2. 数据接收测试：
   - 使用 MQTT 测试工具发送模拟数据
   - 验证温湿度显示是否更新
   - 检查 LED 和风扇状态是否同步

3. 控制命令测试：
   - 点击 LED 开关，观察发送的消息格式
   - 调节风扇速度，确认命令正确发送
   - 使用 MQTT 测试工具确认收到的控制命令

## 更新日志

### 2024-03-21
- 创建基础项目结构
- 实现 MQTT 连接功能
- 添加温湿度显示
- 实现 LED 和风扇控制功能 